---
layout: post
title: Cool pandas hack - get random rows in a multi-column dataframe
date: '2016-12-12T06:14:00.003-08:00'
author: jandom
tags: 
modified_time: '2016-12-12T06:14:53.710-08:00'
blogger_id: tag:blogger.com,1999:blog-2967594273163880803.post-3983098302852031129
blogger_orig_url: https://jandomanski.blogspot.com/2016/12/cool-pandas-hack-get-random-rows-in.html
---

<br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"># </span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"># load inputs</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">#</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">actives = pd.read_pickle("actives_final.pkl")<br />decoys = pd.read_pickle("decoys_final.pkl")</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><br /></span><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"># </span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"># stack tables</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">#<br />df = pd.concat([actives, decoys])<br />&nbsp;</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"># </span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"># remove duplicate indicies</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"># </span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">df = df.reset_index()<br />&nbsp;</span><br /><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">ordered = df.sort_values(by='tc')</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; .groupby(['category', 'molId'])</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; .last()</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; .reset_index()</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;"><br />shuffled = df.sample(frac=1, random_state=123456)</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; .groupby(['category', 'molId'])</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp; .last()</span><br /><span style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp;&nbsp; .reset_index()</span><br />